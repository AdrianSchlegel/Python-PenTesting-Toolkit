import hashlib
import pyfiglet
import sys

def main():

    if len(sys.argv) != 4:
        print("Usage: python hash_cracker.py <wordlist_file> <hash> <algorithm>")
        sys.exit(1)

    wordlist_location = sys.argv[1]
    hash_input = sys.argv[2]
    algorithm = sys.argv[3]

    try:
        with open(wordlist_location, 'r') as file:
            for line in file.readlines():
                line_bytes = line.strip().encode()

                try:
                    hash_object = hashlib.new(algorithm, line_bytes)
                except ValueError:
                    print("Error: Unsupported hashing algorithm. Please use 'md5', 'sha1', 'sha256', etc.")
                    sys.exit(1)

                hashed_password = hash_object.hexdigest()

                if hashed_password == hash_input:
                    print('Found cleartext password: ' + line.strip())
                    break
            else:
                print('No match found in the provided wordlist.')
    except FileNotFoundError:
        print("Error: Wordlist file not found. Please check the file path.")
        sys.exit(1)

if __name__ == "__main__":
    main()