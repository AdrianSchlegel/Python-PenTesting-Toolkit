import scapy.all

def print_help():
    print("Usage:")
    print("python script.py")
    print("Ensure you have the 'interface' and 'ip_range' variables set correctly within the script.")
    print("This script performs an ARP scan on the specified IP range using the specified network interface.")

def arp_scan(interface, ip_range, broadcast_mac="ff:ff:ff:ff:ff:ff"):
    packet = scapy.all.Ether(dst=broadcast_mac) / scapy.all.ARP(pdst=ip_range)
    ans, unans = scapy.all.srp(packet, timeout=2, iface=interface, inter=0.1)
    for send, receive in ans:
        print(receive.sprintf(r"%Ether.src% - %ARP.psrc%"))

def main():
    # Replace with your interface
    interface = "eth0"  

    # Replace with your IP range
    ip_range = "10.10.X.X/24"  

    try:
        arp_scan(interface, ip_range)
    except Exception as e:
        print(f"An error occurred: {e}")
        print_help()

if __name__ == "__main__":
    main()